% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Seurat.Utils.R
\name{addCombinedScore2DGEAResults}
\alias{addCombinedScore2DGEAResults}
\title{addCombinedScore2DGEAResults}
\usage{
addCombinedScore2DGEAResults(
  df = df.markers,
  p_val_min = 1e-25,
  pval_scaling = 0.001,
  colP = "p_val_adj",
  colLFC = CodeAndRoll2::grepv(pattern = c("avg_logFC|avg_log2FC"), x = colnames(df),
    perl = TRUE)
)
}
\arguments{
\item{df}{A data frame containing differential gene expression results, typically produced
by \code{Seurat::FindAllMarkers}. Default: \code{df.markers}.}

\item{p_val_min}{Numeric scalar specifying the minimum allowed p-value; all smaller values
are clipped to this threshold to stabilize the score. Default: \code{1e-25}.}

\item{pval_scaling}{Numeric scalar defining the reference significance level at which the
p-value contribution becomes zero. Values smaller than this increase the score, while
larger values down-weight it. Default: \code{0.001}.}

\item{colP}{Character string giving the name of the column containing (adjusted) p-values.
Default: \code{"p_val_adj"}.}

\item{colLFC}{Character string giving the name of the column containing log-fold change
values. By default, the first column matching \code{avg_logFC} or \code{avg_log2FC}
is selected automatically.}
}
\value{
The input data frame with an additional column named \code{"combined.score"}.
}
\description{
Adds a combined differential expression score that integrates log-fold change (effect size)
with statistical evidence from adjusted p-values. The score is calculated as
\eqn{LFC * -log10(p_adj / pval_scaling)}, where \code{pval_scaling} defines a reference
significance level. P-values are clipped to a minimum threshold to avoid infinite or
excessively large scores. This formulation emphasizes genes that show both strong
expression changes and evidence well beyond a chosen significance baseline, which is
especially useful for single-cell DGE results where very small p-values are common.
}
\examples{
\dontrun{
df.markers <- addCombinedScore2DGEAResults(df.markers)
}

}
